# Project Analysis: Ulasis Customer Intelligence Dashboard

## Project Overview
This is a full-stack web application for customer intelligence and questionnaire management. The frontend is built with React/TypeScript/Vite, and the backend uses Node.js/Express/Sequelize with MySQL database.

## Directory Structure
- **Frontend**: React app in `Frontend/` directory
- **Backend**: Node.js API in `Backend/` directory with migrations, models, controllers
- **Backups**: Contains SQL backup file
- **Docs**: Architecture and specification documents
- **Old Docs**: Debug logs, demos, and analysis files

## Key Issues Identified

### 1. Port Configuration Mismatch
- **Problem**: Frontend API service configured for `http://localhost:3005/api/v1`
- **Reality**: Backend server runs on port 3000
- **Impact**: All API calls from frontend fail with connection errors
- **Evidence**: Demo logs show requests to port 3005, but backend logs show server on 3000

### 2. Authentication Issues in Demo Mode
- **Problem**: Demo mode doesn't properly separate from real API calls
- **Details**: Analytics components attempt API calls even in demo mode when `isDemoMode=true`
- **Impact**: 401 Unauthorized errors for analytics endpoints
- **Evidence**: Demo-3.txt shows GET requests to `/analytics/bubble/1` and `/analytics/summary/1` returning 401

### 3. Backend Internal Server Errors
- **Problem**: Questionnaire creation fails with 500 error
- **Details**: POST to `/api/v1/questionnaires` returns Internal Server Error
- **Possible Causes**: Database connection issues, model validation errors, or bulk question creation failures
- **Evidence**: Demo-3.txt shows failed questionnaire creation with AxiosError 500

### 4. Incomplete Demo Mode Implementation
- **Problem**: Demo mode lacks mock analytics data
- **Details**: Analytics components use empty data in demo mode instead of comprehensive mock data
- **Impact**: Analytics features don't work properly in demo mode
- **Evidence**: AnalyticsIntegrated component uses mock KPI/trend data but empty sentiment/topic analysis

## Data Processing Issues

### User Separation
- **Current State**: Demo mode uses localStorage flag `isDemoMode`
- **Problem**: No clear separation between demo users and real users in database
- **Risk**: Demo data could contaminate real user data

### Analytics Data Processing
- **Backend**: Has comprehensive analytics with bubble charts, summaries, trends
- **Frontend**: Analytics components exist but fail due to API issues
- **Demo Mode**: Only partial mock data available

## Feature Status

### Working Features
- Frontend UI rendering
- Routing and navigation
- Demo mode toggle
- Mock data for reviews, questionnaires, QR codes

### Non-Working Features
- Analytics dashboard (401 errors)
- Questionnaire creation (500 errors)
- Real-time analytics
- User authentication flow
- Database operations

## Detailed Feature Analysis

### Frontend Features

#### 1. Landing Pages
- **About Us Page**: Company information and mission
- **Blog Page**: Articles and updates
- **Careers Page**: Job listings and company culture
- **Contact Page**: Contact form and information
- **Features Page**: Product features showcase
- **Help Center Page**: FAQ and support resources
- **Pricing Page**: Subscription plans and pricing tiers
- **Connection**: Public-facing pages for marketing and user acquisition

#### 2. User Authentication System
- **Login Page**: Email/password authentication
- **Register Page**: User registration with business details
- **Email Verification Page**: Account activation via email
- **Password Reset**: Forgot password functionality
- **Profile Management**: Update personal and business information
- **Connection**: Secures access to application features

#### 3. Dashboard
- **KPI Cards**: Key metrics display (total responses, avg rating, response rate, positive sentiment)
- **Trend Charts**: Time-series data visualization using Recharts
- **Analytics Overview**: Real-time business intelligence
- **Connection**: Central hub displaying processed response data

#### 4. Questionnaire Management
- **Questionnaire List**: Paginated view of user's questionnaires
- **Questionnaire Builder**: Drag-and-drop question creation
- **Question Types**: Rating scales, text inputs, multiple choice, checkboxes, dropdowns
- **Questionnaire Settings**: Themes, welcome/thank you messages, validation rules
- **Connection**: Core functionality for creating customer feedback forms

#### 5. QR Code Management
- **QR Code Generation**: Automatic QR code creation for questionnaires
- **QR Code List**: Manage and track QR code performance
- **Preview Functionality**: Test questionnaire appearance
- **Scan Tracking**: Monitor QR code usage statistics
- **Connection**: Enables offline response collection via mobile devices

#### 6. Response Inbox
- **Review Display**: Customer feedback and ratings
- **Status Management**: Mark reviews as new, in-progress, resolved
- **Filtering and Search**: Find specific responses
- **Response Details**: Full response data with timestamps
- **Connection**: Processes and organizes incoming customer feedback

#### 7. Active Forms (Public Questionnaire View)
- **Public Access**: No-authentication questionnaire display
- **Mobile-Optimized**: Responsive design for mobile devices
- **Progress Tracking**: Multi-step form completion
- **Validation**: Real-time input validation
- **Connection**: Customer-facing interface for response submission

#### 8. Analytics Dashboard
- **Bubble Charts**: Multi-dimensional data visualization
- **Sentiment Analysis**: Positive/neutral/negative classification
- **Topic Analysis**: Automated categorization of feedback
- **Time Comparisons**: Period-over-period analysis
- **Connection**: Transforms raw responses into actionable insights

#### 9. Reports and Export
- **Data Export**: CSV and Excel format downloads
- **Custom Date Ranges**: Flexible reporting periods
- **Raw Data Access**: Complete response datasets
- **Scheduled Reports**: Automated report generation
- **Connection**: Enables data analysis in external tools

#### 10. Settings and Configuration
- **Demo Mode Toggle**: Switch between demo and live data
- **Subscription Management**: Plan upgrades and billing
- **Notification Preferences**: Email and in-app settings
- **Theme Settings**: UI customization
- **Connection**: User preference and system configuration

#### 11. Notification System
- **In-App Notifications**: Real-time alerts within the application
- **Email Notifications**: Automated email alerts
- **Notification History**: Past notification tracking
- **Preference Management**: Customize notification types
- **Connection**: Keeps users informed of important events

#### 12. Subscription and Payment
- **Plan Comparison**: Feature differences across tiers
- **Payment Processing**: Integration with payment gateways (Dana simulation)
- **Usage Tracking**: Monitor feature usage against limits
- **Upgrade Prompts**: Encourage plan upgrades
- **Connection**: Monetization and feature gating

### Backend Features

#### 1. User Management System
- **User Registration**: Account creation with email verification
- **Authentication**: JWT-based login/logout
- **Profile Management**: User information updates
- **Password Security**: Bcrypt hashing and reset functionality
- **Subscription Management**: Plan assignment and limits
- **Connection**: Foundation for multi-tenant application

#### 2. Questionnaire API
- **CRUD Operations**: Create, read, update, delete questionnaires
- **Question Management**: Dynamic question creation and ordering
- **Validation**: Input sanitization and business rule enforcement
- **Ownership Control**: User-based access restrictions
- **Connection**: Powers questionnaire builder functionality

#### 3. Response Collection Engine
- **Anonymous Submissions**: No-authentication response handling
- **Data Validation**: Response format and completeness checks
- **Rate Limiting**: Prevent spam and abuse
- **Audit Logging**: Track all response activities
- **Connection**: Captures customer feedback data

#### 4. Analytics Processing Pipeline
- **Real-time Analytics**: Live KPI calculations
- **Historical Analysis**: Trend and comparison computations
- **Sentiment Analysis**: Automated feedback classification
- **ETL Processes**: Data transformation and aggregation
- **Connection**: Converts responses into business intelligence

#### 5. QR Code Generation Service
- **Dynamic QR Creation**: URL-encoded QR codes
- **Unique Identifiers**: Trackable QR code instances
- **Integration**: Links to specific questionnaires
- **Usage Analytics**: Scan tracking and metrics
- **Connection**: Enables mobile response collection

#### 6. Notification Engine
- **Email Service**: SMTP-based notifications
- **In-App Alerts**: Database-stored notifications
- **Template System**: Customizable message formats
- **Event Triggers**: Automated notification firing
- **Connection**: User communication and engagement

#### 7. Admin Control Panel
- **User Administration**: Manage user accounts and permissions
- **System Monitoring**: Health checks and performance metrics
- **Audit Logs**: Comprehensive activity tracking
- **Subscription Oversight**: Plan management and billing
- **Connection**: System administration and support

#### 8. Security and Monitoring
- **Rate Limiting**: API abuse prevention
- **Request Monitoring**: Performance and error tracking
- **IP Blocking**: Suspicious activity prevention
- **Data Encryption**: Secure data storage
- **Connection**: Protects application integrity

### Feature Interconnections

#### User Journey Flow
1. **User Registration** → Creates account with subscription plan
2. **Questionnaire Creation** → User builds feedback forms with questions
3. **QR Code Generation** → System creates scannable codes linking to questionnaires
4. **Customer Interaction** → Customers scan QR codes and submit responses
5. **Response Processing** → Backend validates and stores response data
6. **Analytics Generation** → ETL processes transform responses into insights
7. **Dashboard Display** → Frontend visualizes analytics for user consumption
8. **Notification Triggers** → System alerts users of new responses or milestones
9. **Report Export** → Users download data for external analysis

#### Data Flow Architecture
- **Input Layer**: Public forms and API endpoints receive responses
- **Processing Layer**: Validation, sanitization, and initial storage
- **Analytics Layer**: Aggregation, sentiment analysis, and KPI calculation
- **Presentation Layer**: Dashboard visualization and report generation
- **Persistence Layer**: MySQL database with optimized queries and indexing

#### Subscription Integration
- **Plan-based Limits**: Questionnaires, responses, and features restricted by subscription tier
- **Usage Tracking**: Real-time monitoring of resource consumption
- **Upgrade Triggers**: Automated prompts when limits are approached
- **Feature Gating**: Conditional access based on subscription level

#### Security Integration
- **Authentication Layer**: JWT tokens protect all authenticated endpoints
- **Authorization Layer**: Role-based and ownership-based access control
- **Audit Layer**: Comprehensive logging of all user and system activities
- **Monitoring Layer**: Real-time security event detection and alerting

## Backend Analysis

### Architecture
- Express.js with middleware for security, monitoring, rate limiting
- Sequelize ORM with migrations
- JWT authentication
- Subscription-based feature limits

### Database Architecture

#### Database Technology
- **MySQL Database**: Primary data store for all environments
- **Sequelize ORM**: Object-relational mapping with migrations
- **Connection Pooling**: Optimized database connections
- **Backup System**: Automated MySQL dumps and restores

#### Core Tables and Relationships

##### User Management
- **users**: User accounts with authentication data
  - Fields: id, email, password_hash, first_name, last_name, business_name, subscription_plan, email_verified, created_at, updated_at
  - Relationships: One-to-many with questionnaires, responses, qr_codes

##### Questionnaire System
- **questionnaires**: Main questionnaire entities
  - Fields: id, user_id, title, description, category_mapping, is_active, is_public, response_count, welcome_message, thank_you_message, theme_settings, settings, created_at, updated_at
  - Relationships: Belongs to user, has many questions, has many responses, has many qr_codes

- **questions**: Individual questions within questionnaires
  - Fields: id, questionnaire_id, question_text, question_type, category, is_required, order_index, configuration, created_at, updated_at
  - Relationships: Belongs to questionnaire, has many answers

##### Response Collection
- **responses**: Response submissions
  - Fields: id, questionnaire_id, user_id (nullable for anonymous), submitted_at, ip_address, user_agent, session_id
  - Relationships: Belongs to questionnaire, has many answers

- **answers**: Individual answers to questions
  - Fields: id, response_id, question_id, answer_value, answer_type, created_at
  - Relationships: Belongs to response and question

##### QR Code System
- **qr_codes**: Generated QR codes
  - Fields: id, user_id, questionnaire_id, name, code_data, scans, color, logo_url, is_active, created_at, updated_at
  - Relationships: Belongs to user and questionnaire

##### Analytics System
- **analytics_kpis**: Key performance indicators
  - Fields: id, questionnaire_id, date, total_responses, avg_rating, response_rate, positive_sentiment, created_at

- **analytics_trends**: Time-series trend data
  - Fields: id, questionnaire_id, period, period_start, period_end, metric_name, metric_value, change_percentage, created_at

- **analytics_breakdown**: Detailed category breakdowns
  - Fields: id, questionnaire_id, category_name, avg_rating, response_count, trend_direction, status, created_at

##### Notification System
- **notifications**: User notifications
  - Fields: id, user_id, type, title, message, is_read, data, created_at
  - Relationships: Belongs to user

##### Subscription System
- **subscriptions**: User subscription records
  - Fields: id, user_id, plan_type, status, start_date, end_date, payment_method, created_at, updated_at
  - Relationships: Belongs to user

##### Audit and Security
- **audit_logs**: System activity logging
  - Fields: id, user_id, action, resource_type, resource_id, old_values, new_values, ip_address, user_agent, created_at

- **admin_users**: Administrative user accounts
  - Fields: id, email, password_hash, role, permissions, is_active, created_at, updated_at

#### Database Relationships Diagram
```
users (1) ──── (many) questionnaires
    │                    │
    │                    ├── (many) questions
    │                    │
    │                    ├── (many) responses
    │                    │         │
    │                    │         └── (many) answers
    │                    │
    └── (many) qr_codes ──┘
         │
         └── links to questionnaires

users (1) ──── (many) notifications
users (1) ──── (many) subscriptions
users (1) ──── (many) audit_logs

questionnaires (1) ──── (many) analytics_kpis
questionnaires (1) ──── (many) analytics_trends
questionnaires (1) ──── (many) analytics_breakdown
```

#### Database Performance Features
- **Indexing Strategy**: Optimized indexes on frequently queried fields
- **Partitioning**: Time-based partitioning for analytics tables
- **Query Optimization**: Efficient JOIN operations and subqueries
- **Connection Limits**: Configured connection pooling
- **Backup Automation**: Scheduled MySQL dumps with verification

### API Endpoints

#### Authentication Endpoints
- `POST /api/v1/auth/register` - User registration
- `POST /api/v1/auth/login` - User login
- `GET /api/v1/auth/profile` - Get user profile
- `PUT /api/v1/auth/profile` - Update user profile
- `POST /api/v1/auth/change-password` - Change password
- `POST /api/v1/auth/forgot-password` - Request password reset
- `POST /api/v1/auth/reset-password` - Reset password
- `GET /api/v1/auth/verify/:token` - Email verification
- `POST /api/v1/auth/refresh` - Refresh JWT token

#### Questionnaire Endpoints
- `GET /api/v1/questionnaires` - List user's questionnaires (paginated)
- `POST /api/v1/questionnaires` - Create new questionnaire
- `GET /api/v1/questionnaires/:id` - Get specific questionnaire
- `PUT /api/v1/questionnaires/:id` - Update questionnaire
- `DELETE /api/v1/questionnaires/:id` - Delete questionnaire
- `POST /api/v1/questionnaires/:id/questions` - Add question to questionnaire
- `GET /api/v1/questionnaires/:id/statistics` - Get questionnaire statistics

#### QR Code Endpoints
- `GET /api/v1/qr-codes` - List user's QR codes
- `POST /api/v1/qr-codes` - Create new QR code
- `GET /api/v1/qr-codes/:id` - Get specific QR code
- `PUT /api/v1/qr-codes/:id` - Update QR code
- `DELETE /api/v1/qr-codes/:id` - Delete QR code

#### Response Endpoints
- `POST /api/v1/responses/anonymous` - Submit anonymous response
- `GET /api/v1/responses` - List responses (authenticated)
- `GET /api/v1/responses/:id` - Get specific response

#### Analytics Endpoints
- `GET /api/v1/analytics/bubble/:questionnaireId` - Get bubble analytics
- `GET /api/v1/analytics/summary/:questionnaireId` - Get analytics summary
- `GET /api/v1/analytics/comparison/:questionnaireId` - Get time comparison
- `GET /api/v1/analytics/report/:questionnaireId` - Export analytics report
- `GET /api/v1/analytics/realtime/:questionnaireId` - Get real-time analytics
- `GET /api/v1/analytics/dashboard/:questionnaireId` - Get dashboard data

#### Subscription Endpoints
- `GET /api/v1/subscription/status` - Get subscription status
- `POST /api/v1/subscription/upgrade` - Upgrade subscription
- `GET /api/v1/subscription/usage` - Get usage statistics

#### Notification Endpoints
- `GET /api/v1/notifications` - List user notifications
- `PUT /api/v1/notifications/:id/read` - Mark notification as read
- `PUT /api/v1/notifications/preferences` - Update notification preferences

#### Admin Endpoints
- `GET /api/v1/admin/users` - List all users
- `GET /api/v1/admin/users/:id` - Get user details
- `PUT /api/v1/admin/users/:id` - Update user
- `DELETE /api/v1/admin/users/:id` - Delete user
- `GET /api/v1/admin/analytics` - System-wide analytics

#### System Endpoints
- `GET /api/v1/health` - Health check
- `GET /api/v1/health/enhanced` - Enhanced health check
- `GET /api/v1/metrics` - System metrics
- `GET /api/v1/uploads/:filename` - Serve uploaded files

## Frontend Analysis

### Tech Stack
- React 19 with TypeScript
- Vite for build tooling
- Axios for API calls
- Recharts for data visualization
- Tailwind CSS

### Components Architecture

#### Core Components
- **App.tsx**: Main application component with routing logic
- **Header/Navigation**: Responsive navigation with user menu
- **Sidebar**: Feature navigation and quick access
- **Footer**: Landing page footer with links

#### Authentication Components
- **LoginPage**: Email/password login form
- **RegisterPage**: Multi-step registration with business info
- **VerifyEmailPage**: Email verification interface
- **ProtectedRoute**: Route guard for authenticated pages

#### Dashboard Components
- **DashboardIntegrated**: Main dashboard with KPIs and charts
- **KPICard**: Individual metric display cards
- **AnalyticsIntegrated**: Comprehensive analytics view
- **Dashboard**: Legacy dashboard component

#### Questionnaire Components
- **QuestionnairesPage**: Questionnaire list and management
- **QuestionnaireBuilder**: Drag-and-drop form builder
- **QuestionnaireForm**: Public response form
- **QuestionnaireCard**: List item display
- **QuestionnaireResults**: Response viewing interface

#### QR Code Components
- **QRCodes**: QR code management interface
- **QRCodeGenerator**: Code generation and display
- **QRCodePreview**: Test questionnaire preview

#### Response Management
- **Inbox**: Response inbox with filtering
- **ActiveForms**: Public questionnaire display
- **Review Components**: Individual response display

#### Analytics Components
- **AnalyticsDashboard**: Analytics overview
- **BubbleChart**: Multi-dimensional visualization
- **TrendChart**: Time-series data display
- **SentimentAnalysis**: Feedback classification
- **TopicAnalysis**: Automated categorization

#### Settings and Configuration
- **Settings**: User preferences and demo mode
- **SubscriptionStatus**: Plan and usage display
- **NotificationPreferences**: Alert configuration
- **PaymentHistory**: Transaction records

#### Landing Page Components
- **LandingPage**: Marketing homepage
- **AboutUsPage**: Company information
- **PricingPage**: Subscription plans
- **FeaturesPage**: Product showcase
- **ContactPage**: Contact form

### State Management Architecture

#### Local State Management
- **React Hooks**: useState, useEffect, useMemo for component state
- **Custom Hooks**: useApi, useAuth, useAnalytics for shared logic
- **Context Providers**: Theme, auth, and app-wide state

#### Persistence Layer
- **localStorage**: User preferences, auth tokens, page state
- **Session Storage**: Temporary data and form state
- **IndexedDB**: Large data caching (future enhancement)

#### Demo Mode Implementation
- **Mock Data System**: Comprehensive fake data generation
- **Mode Switching**: Seamless toggle between demo and live
- **Data Isolation**: Separate storage for demo vs real data
- **Fallback Handling**: Graceful degradation when API unavailable

#### Data Flow Patterns
- **API Layer**: Axios-based HTTP client with interceptors
- **Caching Strategy**: React Query-style caching (planned)
- **Error Boundaries**: Component-level error handling
- **Loading States**: Skeleton screens and spinners

## Recommendations

### Immediate Fixes
1. **Fix Port Configuration**: Change frontend API base URL to `http://localhost:3000/api/v1`
2. **Implement Proper Demo Mode**: Ensure demo mode uses only mock data, no API calls
3. **Fix Backend Errors**: Debug questionnaire creation 500 error (likely database/model issues)
4. **Add Mock Analytics Data**: Extend useMockData to include bubble analytics and summaries

### Long-term Improvements
1. **User Separation**: Implement proper demo/real user isolation
2. **Error Handling**: Better error boundaries and user feedback
3. **Testing**: Add comprehensive tests for both frontend and backend
4. **Database Setup**: Ensure proper database initialization and migrations

### Data Processing Enhancements
1. **Analytics ETL**: Implement proper data processing pipeline
2. **Real-time Updates**: WebSocket or polling for live analytics
3. **Data Validation**: Strengthen input validation and sanitization
4. **Backup/Restore**: Automate database backups

## System Architecture Overview

### Technology Stack Integration
- **Frontend**: React/TypeScript/Vite with Axios for API communication
- **Backend**: Node.js/Express with Sequelize ORM
- **Database**: MySQL with comprehensive schema and relationships
- **Authentication**: JWT tokens with refresh mechanism
- **Real-time**: Polling-based updates (WebSocket planned)
- **Deployment**: Container-ready with environment configuration

### Data Processing Pipeline
1. **Data Collection**: QR code scans → Public forms → Response submission
2. **Data Validation**: Input sanitization → Business rule validation → Storage
3. **Analytics Processing**: ETL pipeline → KPI calculation → Trend analysis
4. **Data Presentation**: API responses → Frontend transformation → Visualization
5. **Data Export**: Report generation → Format conversion → Download

### Security Architecture
- **Authentication**: Multi-factor ready with JWT and refresh tokens
- **Authorization**: Role-based access control with subscription limits
- **Data Protection**: Input sanitization, SQL injection prevention, XSS protection
- **Monitoring**: Request logging, error tracking, rate limiting
- **Compliance**: GDPR considerations with data retention policies

### Scalability Considerations
- **Database**: Indexed queries, connection pooling, read replicas (planned)
- **API**: Rate limiting, caching layers, horizontal scaling ready
- **Frontend**: Code splitting, lazy loading
- **Analytics**: Batch processing, background jobs, caching strategies

## Conclusion
Ulasis is a comprehensive customer intelligence platform with sophisticated features for questionnaire management, response collection, and analytics processing. The MySQL-backed system includes 12+ frontend features and 8+ backend services, all interconnected through a well-designed API architecture. While the codebase demonstrates excellent engineering practices, critical configuration issues (port mismatches, incomplete demo mode) and backend errors currently prevent full functionality. The detailed feature analysis reveals a production-ready application that requires targeted fixes to achieve its full potential as a customer feedback and analytics solution.